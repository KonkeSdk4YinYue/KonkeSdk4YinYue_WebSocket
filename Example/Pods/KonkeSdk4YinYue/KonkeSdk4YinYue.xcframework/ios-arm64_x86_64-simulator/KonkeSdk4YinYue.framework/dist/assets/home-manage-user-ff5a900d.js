import{_ as w,o as l,c as _,a as n,b as s,w as i,f as m,p as U,d as C,t as h,k,F as I,r as H,j as v,e as B}from"./_plugin-vue_export-helper-4f5b7d1e.js";import{I as L}from"./index-bf3f378e.js";/* empty css              *//* empty css              */import{B as N}from"./index-e93e7391.js";import{C as F}from"./index-e990ab3d.js";import{F as Y}from"./index-73da5595.js";import{C as z}from"./index-6a50b8f9.js";import{S as j}from"./index-4a564f33.js";import{R as G,a as K}from"./index-5bde1615.js";import"./index-b5a1cd1d.js";import{_ as O}from"./nav-bar-1594fc52.js";import{B as q,h as f,r as M,l as P}from"./api-308b1525.js";import{O as J}from"./index-fb04ff69.js";import{a as u}from"./function-call-4776fd23.js";import"./use-route-2687c77d.js";import"./index-a604daa8.js";import"./use-id-30d68b53.js";import"./use-touch-6a5c47ae.js";const Q={name:"KonkeSdk4YinYueSrcInputAlert",emits:["confirm","cancel"],props:{value:{type:String,default:null},placeholder:{type:String,default:"请输入"}},data(){return{modelValue:this.value}},mounted(){console.log("mounted")},methods:{onConfirm(){this.$emit("confirm",this.modelValue),this.modelValue=null},onCancel(){this.$emit("cancel"),this.modelValue=null}}},W=e=>(U("data-v-bc041339"),e=e(),C(),e),X={class:"input-alert-container"},Z={class:"input-alert"},$={class:"buttons"},ee=W(()=>n("div",{style:{width:"20px"}},null,-1));function oe(e,o,g,R,t,r){const p=Y,c=N;return l(),_("div",X,[n("div",Z,[s(p,{modelValue:t.modelValue,"onUpdate:modelValue":o[0]||(o[0]=d=>t.modelValue=d),type:"textarea",placeholder:g.placeholder},null,8,["modelValue","placeholder"]),n("div",$,[s(c,{class:"cancel-button",onClick:r.onCancel},{default:i(()=>[m("取消")]),_:1},8,["onClick"]),ee,s(c,{class:"confirm-button",onClick:r.onConfirm},{default:i(()=>[m("确定")]),_:1},8,["onClick"])])])])}const te=w(Q,[["render",oe],["__scopeId","data-v-bc041339"]]);const se={name:"KonkeSdk4YinYueSrcApp",data(){return{homeId:"",userId:"",user:{},rooms:{},showRemarkInput:!1,isEditingRooms:!1}},mounted(){const e=new URLSearchParams(window.location.search);this.homeId=e.get("homeId")||"",this.userId=e.get("userId")||"",this.reloadAll()},methods:{async deleteUser(){try{await q({HUID:this.user.HUID}),window.__jsb.pop()}catch(e){u(e.info||`${e}`)}},async reloadAll(){var e;await this.getUser(),await this.getRooms(),((e=this.user.roomIdsList)==null?void 0:e.length)>0&&this.rooms.forEach(o=>{o.checked=this.user.roomIdsList.includes(o.roomId)})},async onToggleEditingRooms(){if(this.isEditingRooms=!this.isEditingRooms,this.isEditingRooms)return;const e=this.rooms.filter(o=>o.checked).map(o=>o.roomId);try{await f({HUID:this.user.HUID,roomIds:e}),await this.reloadAll()}catch(o){u(o.info||`${o}`)}},async getRooms(){try{const{data:e}=await M(),{roomList:o}=e;this.rooms=o}catch(e){console.log(e)}},async onConfirm(e){this.showRemarkInput=!1;try{await f({HUID:this.user.HUID,remark:e}),this.user.remark=e}catch(o){u(o.info||`${o}`)}},onCancel(){this.showRemarkInput=!1},async getUser(){try{const{data:e}=await P(this.homeId);this.user=e.homeUserList.find(o=>o.sUser.userId==this.userId)||{},console.log(this.user)}catch(e){console.log(e)}},async onUpdateRoleType(){try{await f({HUID:this.user.HUID,roleType:this.user.roleType}),this.reloadAll()}catch(e){u(e.info||"更新失败")}}}},ne=e=>(U("data-v-ec699af4"),e=e(),C(),e),re={class:"home-manage"},ae={class:"user-info-row"},ie={class:"names-column"},le={class:"nickname"},ce={class:"remark"},me={class:"role-row"},de={class:"manage-rooms-row"},ue=ne(()=>n("div",null,"共享房间",-1));function _e(e,o,g,R,t,r){var y;const p=O,c=L,d=K,V=G,b=j,S=F,T=z,x=te,E=J;return l(),_(I,null,[n("div",re,[s(p,{title:"管理成员",border:!1,"right-text":"删除",onClickRight:r.deleteUser},null,8,["onClickRight"]),n("div",ae,[s(c,{name:"manager-o",size:"70"}),n("div",ie,[n("div",le,h((y=t.user.sUser)==null?void 0:y.nickname),1),n("div",ce,[m(h(t.user.remark)+" ",1),s(c,{name:"edit",onClick:o[0]||(o[0]=a=>t.showRemarkInput=!0)})])])]),n("div",me,[s(V,{modelValue:t.user.roleType,"onUpdate:modelValue":o[1]||(o[1]=a=>t.user.roleType=a),direction:"horizontal",style:{padding:"16px"}},{default:i(()=>[s(d,{name:"User",onClick:r.onUpdateRoleType},{default:i(()=>[m("普通用户")]),_:1},8,["onClick"]),s(d,{name:"Manager",onClick:r.onUpdateRoleType},{default:i(()=>[m("管理员")]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),n("div",de,[ue,t.user.roleType=="User"?(l(),_("div",{key:0,onClick:o[2]||(o[2]=(...a)=>r.onToggleEditingRooms&&r.onToggleEditingRooms(...a))},h(t.isEditingRooms?"完成":"管理"),1)):k("",!0)]),s(T,{inset:"",style:{"margin-bottom":"16px"}},{default:i(()=>[(l(!0),_(I,null,H(t.rooms,(a,A)=>(l(),v(S,{key:A,title:a.roomName},{"right-icon":i(()=>[t.user.roleType=="User"?(l(),v(b,{key:0,modelValue:a.checked,"onUpdate:modelValue":D=>a.checked=D,size:"20",disabled:!t.isEditingRooms},null,8,["modelValue","onUpdate:modelValue","disabled"])):k("",!0)]),_:2},1032,["title"]))),128))]),_:1})]),s(E,{show:t.showRemarkInput},{default:i(()=>[s(x,{onConfirm:o[3]||(o[3]=a=>r.onConfirm(a)),onCancel:r.onCancel},null,8,["onCancel"])]),_:1},8,["show"])],64)}const pe=w(se,[["render",_e],["__scopeId","data-v-ec699af4"]]);B(pe).mount("#root");
